import{u as E,C as u,j as o,D as v,x as I}from"./main.a58435d9.js";document.addEventListener("DOMContentLoaded",function(g){document.getElementById("btn-file-input").addEventListener("click",function(t){document.getElementById("thumbsnail-get-path").click()}),document.getElementById("thumbsnail-get-path").addEventListener("change",function(t){const e=t.target.files[0];let n=document.getElementById("thumbsnail-upload-form");const a=new FormData(n);if(a.append("file",e),E.files.upload(a,n,function(d){const m=d.data[0],r=u.config.urlRoot+"/files/"+m.location;document.getElementById("thumbsnail-path").value=r,console.log("Thumbnail uploaded successfully:",r);const y=document.getElementById("image-preview");y.src=r,y.style.display="block"}),e){const d=new FileReader;d.onload=function(m){const r=document.getElementById("image-preview");r.src=m.target.result,r.style.display="block"},d.readAsDataURL(e)}});const i=Object.keys(document.categories),c=document.getElementById("categories-selector");i.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,e.textContent!="D\xE9fi Flash"&&c.appendChild(e)});const s=document.createElement("option");s.value="other",s.textContent="Other (type below)",c.appendChild(s);const l=document.getElementById("categories-selector-input");c.value=="other"||i.length==0?(l.style.display="block",l.name="category"):(l.style.display="none",l.value="",l.name=""),c.addEventListener("change",function(){c.value=="other"||i.length==0?(l.style.display="block",l.name="category"):(l.style.display="none",l.value="",l.name="")});let h=0;document.querySelectorAll("td.id").forEach(function(t){const e=parseInt(t.textContent);!isNaN(e)&&e>h&&(h=e)});const p=h+1;document.getElementById("challenge_id_texte").textContent=p,document.getElementById("challenge_id").value=p;function b(){const t=o("#challenge-create-options-quick").serializeJSON();let e=document.getElementById("categories-selector"),n=document.getElementById("categories-selector-input"),a=document.getElementById("time-selector-input");e.hidden&&t.type!="flash"?(a.hidden=!0,n.hidden=!1,e.hidden=!1):!e.hidden&&t.type=="flash"&&(a.hidden=!1,n.hidden=!0,e.hidden=!0)}function f(t){const e=o("#challenge-create-options-quick").serializeJSON();delete e.challenge_id,delete e.flag_type,e.type!="flash"?(delete e.startTime,delete e.endTime):e.category="D\xE9fi Flash",e.description="",u.fetch("/api/v1/challenges",{method:"POST",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(n){return console.log("hello2"),n.json()}).then(function(n){if(n.success){if(n.data.type=="manualRecursive"){const a={value:"R\xE9cursif",challenge:n.data.id};u.api.post_tag_list({},a).then(d=>{})}if(n.data.type=="flash"){const a={value:"Flash",challenge:n.data.id};u.api.post_tag_list({},a).then(d=>{})}setTimeout(function(){window.location.reload(!0)},500)}else{let a="";for(const d in n.errors)a+=n.errors[d].join(`
`),a+=`
`;v({title:"Error",body:a,button:"OK"})}})}document.getElementById("submit-button").addEventListener("click",function(t){t.preventDefault(),f()}),document.getElementById("challenge-create-options-quick-selector").addEventListener("keypress",function(t){t.key==="Enter"&&(t.preventDefault(),f())}),document.getElementById("challenge-type").addEventListener("change",function(t){b()})});function k(g){let i=o("input[data-challenge-id]:checked").map(function(){return o(this).data("challenge-id")}),c=i.length===1?"challenge":"challenges";I({title:"Delete Challenges",body:`Are you sure you want to delete ${i.length} ${c}?`,success:function(){const s=[];for(var l of i)s.push(u.fetch(`/api/v1/challenges/${l}`,{method:"DELETE"}));Promise.all(s).then(h=>{window.location.reload()})}})}function C(g){let i=o("input[data-challenge-id]:checked").map(function(){return o(this).data("challenge-id")});v({title:"Edit Challenges",body:o(`
    <form id="challenges-bulk-edit">
      <div class="form-group">
        <label>Category</label>
        <input type="text" name="category" data-initial="" value="">
      </div>
      <div class="form-group">
        <label>Value</label>
        <input type="number" name="value" data-initial="" value="">
      </div>
      <div class="form-group">
        <label>State</label>
        <select name="state" data-initial="">
          <option value="">--</option>
          <option value="visible">Visible</option>
          <option value="hidden">Hidden</option>
        </select>
      </div>
    </form>
    `),button:"Submit",success:function(){let c=o("#challenges-bulk-edit").serializeJSON(!0);const s=[];for(var l of i)s.push(u.fetch(`/api/v1/challenges/${l}`,{method:"PATCH",body:JSON.stringify(c)}));Promise.all(s).then(h=>{window.location.reload()})}})}o(()=>{o("#challenges-delete-button").click(k),o("#challenges-edit-button").click(C)});
