import{m as g,C as p}from"./index.5095421b.js";import{t as f,g as y}from"./index.9dc8c57c.js";import"./echarts.54e741c1.js";import{e as E,h as C}from"./CommentBox.3be5197b.js";window.Alpine=g;window.CTFd=p;window.ScoreboardDetail=0;window.standings=0;window.nbStandings=0;window.scoreboardListLoaded=!1;window.allImages=[];window.allSubmited=[];window.maxCount=0;window.maxCountIncrease=5;window.imageInit=!1;window.theninit=0;window.decalage=0;window.laoded=0;window.splashPosition={1:[["-55px","0","-30px","0px"],["0px","-50px","50%","0px"],["","-50px","0px","0px"]],2:[["-50px","0px","35%","0"],["","-10px","60%","0px"],["-40px","","-35px","0px"]],3:[["-45px","0px","65%","0"],["","-30px","60%","0px"],["15%","","-35px","0px"]],4:[["-40px","0px","-10%","0"],["","-40px","60%","0"],["-40px","","-35px","0px"]],5:[["-40px","0px","-10%","0"],["","-30px","60%","0"],["","-30px","-25px","0px"]],6:[["-0px","0px","-30%","0"],["","40px","60%","0"],["","-30px","-30px","0px"]]};window.scoreboardSplashPosition={1:["95px","","","105px"],2:["110px","","","50px"],3:["85px","","-195px",""],4:["130px","","","190px"],5:["90px","","","290px"]};g.data("ScoreboardDetail",()=>({data:{},rankings:[],top:{},show:!0,async init(){window.standings=await p.pages.scoreboard.getScoreboard(),window.ScoreboardDetail=await p.pages.scoreboard.getScoreboardDetail(window.standings.length),document.getElementById("score-graph"),this.rankings=f(window.standings),this.top=this.rankings[0],this.show=window.standings.length>0}}));globalThis.loserSplash=function(n,e){if(n.value!="laoded"){if(n.parentElement.style.position="abosolute",window.standings.length-1==e)n.src="/themes/core/static/img/splash"+1+".png",n.parentElement.style.top="125px",n.parentElement.style.right="75%";else{n.src="/themes/core/static/img/splash"+(e%5+1)+".png";let a=window.scoreboardSplashPosition[e%5+1];n.parentElement.style.top=a[0],n.parentElement.style.left=a[2],n.parentElement.style.right=a[3]}n.value="laoded"}};g.data("ScoreboardList",()=>({standings:[],brackets:[],activeBracket:null,async init(){if(window.standings.length!=0){const e=await(await p.fetch(`/api/v1/brackets?type=${p.config.userMode}`,{method:"GET"})).json();this.brackets=e.data;const o=await(await p.fetch("/api/v1/challenges",{method:"GET"})).json();let i={};for(let t=0;t<o.data.length;t++)i[o.data[t].id]=o.data[t].name;if(window.ScoreboardDetail==0||window.standings==0)this.init();else{let t=y(window.ScoreboardDetail,window.standings,i);for(let l=0;l<t.length;l++)t[l].provided||(t[l].provided=t[l].date),this.standings[l]=t[l]}window.nbStandings=this.standings.length}}}));g.data("LogImage",()=>({async init(){let n=!1,e=0;try{e=JSON.parse(this.id)[0].id,window.allImages.push(e),window.allSubmited.push(e)}catch{n=!0;let o="";this.id=="Media en train d'\xEAtre trait\xE9"&&(o="Media en train d'\xEAtre trait\xE9"),e=o+"%"+String(Math.random()*1e17),window.allSubmited.push(e)}if(window.allSubmited.length>window.maxCount){let a=document.getElementById(this.id);(this.type=="manual"||this.type=="manualRecursive")&&(a.className+="inSubmission"),n||(a.text=this.challenge_id);try{a.id=e,a.hidden=!0}catch{this.id=e}}(window.allSubmited.length==window.maxCountIncrease||window.allSubmited.length==window.nbStandings)&&(window.imageInit||window.allSubmited.length!=0&&(window.imageInit=!0,self.showXMore()))}}));globalThis.showXMore=async function(n){let e=[];for(let t=window.maxCount;t<window.maxCount+window.maxCountIncrease;t++)try{if(t<window.allSubmited.length){if(!window.allSubmited[t].toString().includes("%"))e.push(window.allImages[t-window.decalage]);else{document.getElementById(window.allSubmited[t]).getElementsByClassName("header")[1].style.height="100px",document.getElementById(window.allSubmited[t]).getElementsByClassName("header")[1].style.width="186px";let l=(Math.random()>.5?-1:1)*(Math.random()*6);document.getElementById(window.allSubmited[t]).style.transform+="rotate("+l+"deg)";let s=document.getElementById(window.allSubmited[t]).getElementsByClassName("splash"),d=window.splashPosition[Math.floor(Math.random()*6)+1];for(let h=0;h<s.length;h++){let r=d[h],m=s[h];m.firstChild.style.top=r[0],m.firstChild.style.bottom=r[1],m.firstChild.style.left=r[2],m.firstChild.style.right=r[3],m.firstChild.src="/themes/core/static/img/splash"+(Math.floor(Math.random()*5)+1)+".png"}window.laoded+=1,window.decalage++}document.getElementById(window.allSubmited[t]).hidden=!1}}catch{}const o=await(await p.fetch("/api/v1/teams?ids="+JSON.stringify(e),{method:"GET"})).json();for(let t=0;t<window.maxCountIncrease;t++)try{if(t<e.length){let l=o.data[t].provided,s=document.getElementById(e[t]),d=!1;try{d=JSON.parse(l)}catch{}if(d){let h=!1;for(let r=0;r<d.length;r++)if(d[r].type=="thumbsnail"){h=!0;let m=createMediaElement(d[r]);m.style["max-width"]="100%",m.style.display="block",m.style.height="auto",m.onload=function(w){stylingImage(w)},s.getElementsByClassName("imageContainer")[0].appendChild(m),s.getElementsByClassName("imageContainer")[0].onclick=showLargeSubmissions,s.value=l}if(!h){let r=document.createElement("p");r.textContent="No thumbsnail Available for the current media",s.getElementsByClassName("imageContainer")[0].appendChild(r)}}}}catch{}window.maxCount+=window.maxCountIncrease,(window.laoded==window.allSubmited.length||window.laoded==window.maxCount)&&drawLines(),window.allSubmited.length<=window.maxCount&&(document.getElementById("plus-btn").disabled=!0);let i=document.getElementsByClassName("award-icon");for(let t=0;t<i.length;t++)i[t].parentElement.getElementsByClassName("challenge_name")[0].textContent||(i[t].hidden=!1,i[t].parentElement.getElementsByClassName("challenge_name")[0].hidden=!0)};globalThis.stylingImage=function(n){const e=n.target;e.naturalWidth>e.naturalHeight?(e.classList.add("landscape"),e.parentElement.classList.add("landscape-td"),e.parentElement.parentElement.parentElement.classList.add("landscape-td")):(e.classList.add("portrait"),e.parentElement.classList.add("portrait-td"),e.parentElement.parentElement.parentElement.classList.add("portrait-td"));let a=(Math.random()>.5?-1:1)*(Math.random()*6);e.parentElement.parentElement.parentElement.style.transform+="rotate("+a+"deg)";let o=e.parentElement.parentElement.parentElement.getElementsByClassName("splash"),i=window.splashPosition[Math.floor(Math.random()*6)+1];for(let t=0;t<o.length;t++){let l=i[t],s=o[t];s.firstChild.style.top=l[0],s.firstChild.style.bottom=l[1],s.firstChild.style.left=l[2],s.firstChild.style.right=l[3],s.firstChild.src="/themes/core/static/img/splash"+(Math.floor(Math.random()*5)+1)+".png"}window.laoded+=1,(window.laoded==window.allSubmited.length||window.laoded==window.maxCount)&&drawLines()};globalThis.drawLines=function(){document.body.getBoundingClientRect();let n=window.maxCount-window.maxCountIncrease;for(let i=n==0?n:n-2;i<window.laoded-1;i++){var e=document.getElementsByClassName("lineCanvas")[i];try{let t=document.getElementsByClassName("lineStart")[i],l=document.getElementsByClassName("lineStart")[i+1],s=t.getBoundingClientRect(),d=l.getBoundingClientRect();var e=document.getElementsByClassName("lineCanvas")[i];let r=e.parentElement.parentElement.parentElement.style.transform,m=parseFloat(r.split("rotate(")[1].split("deg")[0]);e.style.transform="rotate("+-m+"deg)",e.style.left=(d.left<s.left?d.left-s.left:0)+"px",console.log(l);let w=e.getBoundingClientRect();console.log(d.left),e.width=d.left-w.left+Math.abs(s.left-w.left)+t.offsetHeight/2,e.height=d.top-w.top+Math.abs(s.top-w.top)+t.offsetWidth/2;let c={x:s.left-w.left+t.offsetWidth/2,y:s.top-w.top+t.offsetHeight/2},u={x:d.left-w.left+(d.left<s.left?t.offsetWidth:0),y:d.top-w.top+l.offsetHeight/4};var a=e.getContext("2d"),o=a.createLinearGradient(c.x,c.y,u.x,e.height);o.addColorStop(0,t.value),o.addColorStop(1,l.value),a.setLineDash([40,20]),a.strokeStyle=o,a.beginPath(),a.lineWidth="7",a.moveTo(c.x,c.y),a.lineTo(u.x,u.y),a.stroke()}catch(t){e.style.width="0px",console.log(t)}}};globalThis.createMediaElement=function(n){let e;return n.type=="video/webm"?(e=document.createElement("video"),e.controls=!0,e.type="video/webm",e.poster=""):(n.type=="image/png"||n.type=="thumbsnail")&&(e=document.createElement("img"),e.type="image/png"),e.src="/files/"+n.location,e};globalThis.showLargeSubmissions=function(n){window.carouselPosition=0;let e,a;try{e=JSON.parse(n.srcElement.parentElement.parentElement.value),a=n.srcElement.parentElement.parentElement}catch{e=JSON.parse(n.srcElement.parentElement.parentElement.parentElement.value),a=n.srcElement.parentElement.parentElement.parentElement}let o=!1;window.carouselMax=e.length-1;let i="<section class='slider-wrapper'><ul class='slides-container list-unstyled' style:'list-style: none !important;' id='slides-container'>";for(let t=0;t<e.length;t++)if(e[t].type!="thumbsnail"){let l=createMediaElement(e[t]);l.style.width="100%",l.style.objectFit="contain",l.style.height="500px";let s=document.createElement("div");s.append(l),i+='<li class="slide '+(o?t-1:t)+'slide" style="min-height:50%">',i+=s.innerHTML,i+="</li>"}else o=!0;i+="</ul></section>",i+="<img src onerror='reloadCarousel(this.parentElement);'></img>",i+=`<button class='btn btn-primary carousel__navigation-button slide-arrow-prev' id='slide-arrow-prev' onclick='downCarousel(this)' style='display:block;position:absolute;top:40%;left:1rem;'><svg viewBox="0 0 100 100"><path d="M 50,0 L 60,10 L 20,50 L 60,90 L 50,100 L 0,50 Z" class="arrow" fill="white" transform="translate(15,0) rotate(0)"></path></svg></button>`,i+=`<button style='position:absolute;top:40%;right:1rem;' class='btn btn-primary carousel__navigation-button slide-arrow-next' id='slide-arrow-next' onclick='upCarousel(this)'><svg viewBox="0 0 100 100"><path d="M 50,0 L 60,10 L 20,50 L 60,90 L 50,100 L 0,50 Z" class="arrow" fill="white" transform="translate(85,100) rotate(180)"></path></svg></button>`,E({title:"Visioneurs",body:i,button:"retour",challenge_id:a.text,ids:a.id,additionalClassMain:"FullSizeCarousel"},C,p.user),document.getElementsByClassName("modal-dialog")[0].style.listStyle="none"};window.upCarousel=function(n){window.carouselPosition+=1,window.carouselPosition!=window.carouselMax-1?(window.reloadCarousel(n.parentElement),n.parentElement.getElementsByClassName("slide-arrow-prev")[0].hidden=!1):(window.reloadCarousel(n.parentElement),n.parentElement.getElementsByClassName("slide-arrow-next")[0].hidden=!0,n.parentElement.getElementsByClassName("slide-arrow-prev")[0].hidden=!1)};window.downCarousel=function(n){window.carouselPosition-=1,window.carouselPosition!=0?(window.reloadCarousel(n.parentElement),n.parentElement.getElementsByClassName("slide-arrow-next")[0].hidden=!1):(window.reloadCarousel(n.parentElement),n.parentElement.getElementsByClassName("slide-arrow-prev")[0].hiddend=!0,n.parentElement.getElementsByClassName("slide-arrow-next")[0].hidden=!1)};window.reloadCarousel=function(n){window.carouselPosition==0&&(n.getElementsByClassName("slide-arrow-prev")[0].hidden=!0),window.carouselMax==1&&(n.getElementsByClassName("slide-arrow-next")[0].hidden=!0);for(let e=0;e<window.carouselMax;e++)if(e==window.carouselPosition)n.getElementsByClassName(e+"slide")[0].hidden=!1;else{n.getElementsByClassName(e+"slide")[0].hidden=!0;let a=n.getElementsByClassName(e+"slide")[0].firstChild;a.nodeName=="VIDEO"&&a.pause()}};g.start();
