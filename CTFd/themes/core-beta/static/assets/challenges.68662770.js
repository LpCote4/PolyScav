import{C as a,m as o,h,T as c,d as u,M as g,a as p}from"./index.5095421b.js";import{V as f,C as w,h as m}from"./CommentBox.6d8c9990.js";window.values=[];window.TEAM_ID=a.team.id;window.USER_ID=a.user.id;function d(e){let s=new DOMParser().parseFromString(e,"text/html");return s.querySelectorAll('a[href*="://"]').forEach(l=>{l.setAttribute("target","_blank")}),s.documentElement.outerHTML}window.Alpine=o;o.store("challenge",{data:{view:""}});o.data("Hint",()=>({id:null,html:null,async showHint(e){if(e.target.open){let s=(await a.pages.challenge.loadHint(this.id)).data;if(s.content)this.html=d(s.html);else if(await a.pages.challenge.displayUnlock(this.id)){let l=await a.pages.challenge.loadUnlock(this.id);if(l.success){let i=(await a.pages.challenge.loadHint(this.id)).data;this.html=d(i.html)}else e.target.open=!1,a._functions.challenge.displayUnlockError(l)}else e.target.open=!1}}}));o.data("Challenge",()=>({id:null,next_id:null,submission:"",tab:null,solves:[],response:null,share_url:null,async init(){h()},getStyles(){let e={"modal-dialog":!0};try{switch(a.config.themeSettings.challenge_window_size){case"sm":e["modal-sm"]=!0;break;case"lg":e["modal-lg"]=!0;break;case"xl":e["modal-xl"]=!0;break;default:break}}catch(t){console.log("Error processing challenge_window_size"),console.log(t)}return e},async init(){h()},async showChallenge(){new c(this.$el).show()},async showSolves(){this.solves=await a.pages.challenge.loadSolves(this.id),this.solves.forEach(e=>(e.date=u(e.date).format("MMMM Do, h:mm:ss A"),e)),new c(this.$el).show()},async showComments(){const e=f.extend(w);let t=document.createElement("div");document.querySelector("#comment-box").removeChild(document.querySelector("#comment-box").firstChild),document.querySelector("#comment-box").appendChild(t),new e({propsData:{type:"team",id:window.TEAM_ID,challenge_id:this.id}}).$mount(t),new c(this.$el).show()},getNextId(){return o.store("challenge").data.next_id},async nextChallenge(){let e=g.getOrCreateInstance("[x-ref='challengeWindow']");e._element.addEventListener("hidden.bs.modal",t=>{o.nextTick(()=>{this.$dispatch("load-challenge",this.getNextId())})},{once:!0}),e.hide()},async getShareUrl(){let e={type:"solve",challenge_id:this.id};const n=(await(await a.fetch("/api/v1/shares",{method:"POST",body:JSON.stringify(e)})).json()).data.url;this.share_url=n},copyShareUrl(){navigator.clipboard.writeText(this.share_url);let e=p.getOrCreateInstance(this.$el);e.enable(),e.show(),setTimeout(()=>{e.hide(),e.disable()},2e3)},async submitChallenge(){console.log(this.submission),this.response=await a.pages.challenge.submitChallenge(this.id,this.submission),await this.renderSubmissionResponse()},async renderSubmissionResponse(){this.response.data.status==="correct"&&(this.submission=""),this.$dispatch("load-challenges")},async submitManualChallenge(){if(document.getElementById("file-input").hidden)document.getElementById("text-input").value!=""?(this.response=await a.pages.challenge.submitChallenge(this.id,document.getElementById("text-input").value),this.response.success?(this.response.data.status="correct",this.response.data.message="succesfuly send!"):(this.response.data.status="incorrect",this.response.data.message="en error happen pls contact the admin"),this.$dispatch("load-challenges")):alert("You're currently trying to send nothing."),document.getElementById("spinner").hidden=!0;else{let t=document.getElementById("form-file-input");document.getElementById("form-file-input").value=this;var e=new FormData(t);if(Object.fromEntries(e).file.name!="")try{await m.files.upload(t,{id:this.id,type:"manual"},async function(s){document.getElementById("form-file-input").value.$dispatch("load-challenges")})}catch(s){this.response={},this.response.data={},this.response.data.status="incorrect",this.response.data.message="en error happen pls contact the admin for "+s,this.$dispatch("load-challenges"),document.getElementById("challenge-submit").disabled=!1,document.getElementById("spinner").hidden=!0}else alert("You're currently trying to send nothing.")}document.getElementById("file-input").textContent="Selectioner un fichier",document.getElementById("text-input").value=""}}));o.data("ChallengeBoard",()=>({loaded:!1,challenges:[],challenge:null,async init(){let e={};e.team_id=window.TEAM_ID;let t=e;t.page=1,t.per_page=1e4,this.challenges=await a.pages.challenges.getChallenges();let s=await a.pages.scoreboard.getScoreboard();await a.pages.scoreboard.getScoreboardDetail(s.length),this.comments=await m.comments.get_comments(t),this.maxScore=0,this.solveScore=0,this.submitScore=0;for(let n in this.challenges){let l=this.challenges[n].value;this.challenges[n].solved_by_me?this.solveScore+=l:this.challenges[n].submited&&(this.submitScore+=l),this.maxScore+=l}document.getElementById("scoreProgressTitle").textContent=this.solveScore+this.submitScore+" points",document.getElementById("scoreProgressBar").value=100*((this.solveScore+this.submitScore)/this.maxScore),document.getElementById("scoreProgressText").textContent=""+parseInt(100*(this.submitScore/(this.solveScore+this.submitScore)))+"% des points en approbations",this.commentsChallengeDict={};for(let n in this.comments.data){let l=this.comments.data[n].content;if(l.search("#")!=-1){l=l.split("#")[1];let r=l.search(":"),i=0;r!=-1,i=parseInt(l.split(":")[0]),this.commentsChallengeDict[i]!=null?this.commentsChallengeDict[i]=this.commentsChallengeDict[i]+1:this.commentsChallengeDict[i]=1}}for(let n in this.commentsChallengeDict)document.getElementById(n+"a").className="fas fa-comments float-end",document.getElementById(n).textContent=this.commentsChallengeDict[n]>99?99:this.commentsChallengeDict[n];if(this.loaded=!0,window.location.hash){let n=decodeURIComponent(window.location.hash.substring(1)),l=n.lastIndexOf("-");if(l>=0){let i=[n.slice(0,l),n.slice(l+1)][1];await this.loadChallenge(i)}}},getCategories(){const e=[];this.challenges.forEach(t=>{const{category:s}=t;e.includes(s)||e.push(s)});try{const t=a.config.themeSettings.challenge_category_order;if(t){const s=new Function(`return (${t})`);e.sort(s())}}catch(t){console.log("Error running challenge_category_order function"),console.log(t)}return e},getChallenges(e){let t=this.challenges;e!==null&&(t=this.challenges.filter(s=>s.category===e));try{const s=a.config.themeSettings.challenge_order;if(s){const n=new Function(`return (${s})`);t.sort(n())}}catch(s){console.log("Error running challenge_order function"),console.log(s)}return t},async loadChallenges(){this.challenges=await a.pages.challenges.getChallenges()},async loadChallenge(e){await a.pages.challenge.displayChallenge(e,t=>{t.data.view=d(t.data.view),o.store("challenge").data=t.data,o.nextTick(()=>{let s=g.getOrCreateInstance("[x-ref='challengeWindow']");s._element.addEventListener("hidden.bs.modal",n=>{history.replaceState(null,null," ")},{once:!0}),s.show(),history.replaceState(null,null,`#${t.data.name}-${e}`)})})}}));o.start();globalThis.hit=function(){let e=document.getElementById("file-input"),t=document.getElementById("text-input"),s=document.getElementById("file-input-fa"),n=document.getElementById("text-input-fa");t.hidden?(e.hidden=!0,t.hidden=!1,s.hidden=!1,n.hidden=!0):(e.hidden=!1,t.hidden=!0,s.hidden=!0,n.hidden=!1)};globalThis.changeLabel=function(e){let t=e.target.files.length+" folder(s) uploded",s=0,n=["hevc","mp4","avi","mkv","mov","MOV","wmv","flv","webm","mpeg","3gp","ogv"],l=["jpeg","png","gif","bmp","tiff","svg","webp","raw","heic","ico","jpg"];for(let r=0;r<e.target.files.length;r++){let i=e.target.files[r].name.split(".")[1];console.log(e.target.files[r]),s+=e.target.files[r].size,!n.includes(i.toLowerCase())&&!l.includes(i.toLowerCase())&&alert("We can not garented ."+i+" will be supported")}s>2e8&&s<2e9?alert("The folders you're trying to upload are bigger than 200MB and will be further compressed to reduce their size even more. This may impact the quality and the upload time by a lot!. FolderSize: "+s/1e6+"MB"):s>2e9&&alert("File can't be bigger than 2GB, even with compression. Please use external tools and share it with a link"),e.target.files.length>20&&(alert("We know you have a lot to flex, but you cannot upload more than 20 files at a time."),t="",e.target.value="",document.getElementById("file-input").textContent=t),document.getElementById("file-input").textContent=t};
