import{m as c,C as h}from"./index.5095421b.js";import{t as y,g as E}from"./index.abc18a45.js";import"./echarts.54e741c1.js";import{e as C,h as x}from"./CommentBox.a72127e2.js";window.Alpine=c;window.CTFd=h;window.ScoreboardDetail=0;window.standings=0;window.nbStandings=0;window.scoreboardListLoaded=!1;window.allImages=[];window.allSubmited=[];window.maxCount=0;window.maxCountIncrease=5;window.imageInit=!1;window.theninit=0;window.decalage=0;window.laoded=0;window.canShowMore=!0;window.splashPosition={1:[["-55px","0","-30px","0px"],["0px","-50px","50%","0px"],["","-50px","0px","0px"]],2:[["-50px","0px","35%","0"],["","-10px","60%","0px"],["-40px","","-35px","0px"]],3:[["-45px","0px","65%","0"],["","-30px","60%","0px"],["15%","","-35px","0px"]],4:[["-40px","0px","-10%","0"],["","-40px","60%","0"],["-40px","","-35px","0px"]],5:[["-40px","0px","-10%","0"],["","-30px","60%","0"],["","-30px","-25px","0px"]],6:[["-0px","0px","-30%","0"],["","40px","60%","0"],["","-30px","-30px","0px"]]};window.scoreboardSplashPosition={1:["95px","","","105px"],2:["110px","","","50px"],3:["85px","","-195px",""],4:["130px","","","190px"],5:["90px","","","290px"]};c.data("ScoreboardDetail",()=>({data:{},rankings:[],top:{},show:!0,async init(){window.standings=await h.pages.scoreboard.getScoreboard(),window.ScoreboardDetail=await h.pages.scoreboard.getScoreboardDetail(window.standings.length),document.getElementById("score-graph"),this.rankings=y(window.standings),this.top=this.rankings[0],this.show=window.standings.length>0}}));globalThis.loserSplash=function(t,e){if(t.value!="laoded"){if(t.parentElement.style.position="abosolute",window.standings.length-1==e)t.src="/themes/core/static/img/splash"+1+".png",t.parentElement.style.top="125px",t.parentElement.style.right="75%";else{t.src="/themes/core/static/img/splash"+(e%5+1)+".png";let a=window.scoreboardSplashPosition[e%5+1];t.parentElement.style.top=a[0],t.parentElement.style.left=a[2],t.parentElement.style.right=a[3]}t.value="laoded"}};c.data("ScoreboardList",()=>({standings:[],brackets:[],activeBracket:null,async init(){if(window.standings.length!=0){const e=await(await h.fetch(`/api/v1/brackets?type=${h.config.userMode}`,{method:"GET"})).json();this.brackets=e.data;const i=await(await h.fetch("/api/v1/challenges",{method:"GET"})).json();let s={};for(let n=0;n<i.data.length;n++)s[i.data[n].id]=i.data[n].name;if(window.ScoreboardDetail==0||window.standings==0)this.init();else{let n=E(window.ScoreboardDetail,window.standings,s);for(let l=0;l<n.length;l++)n[l].provided||(n[l].provided=n[l].date),this.standings[l]=n[l]}window.nbStandings=this.standings.length}}}));c.data("LogImage",()=>({async init(){let t=!1,e=0;try{e=JSON.parse(this.id)[0].id,window.allImages.push(e),window.allSubmited.push(e)}catch{t=!0;let i="";this.id=="Media en train d'\xEAtre trait\xE9"&&(i="Media en train d'\xEAtre trait\xE9"),e=i+"%"+String(Math.random()*1e17),window.allSubmited.push(e)}if(window.allSubmited.length>window.maxCount){let a=document.getElementById(this.id);(this.type=="manual"||this.type=="manualRecursive"||this.type=="flash")&&(a.className+="inSubmission"),t||(a.text=this.challenge_id);try{a.id=e,a.hidden=!0}catch{this.id=e}}(window.allSubmited.length==window.maxCountIncrease||window.allSubmited.length==window.nbStandings)&&(window.imageInit||window.allSubmited.length!=0&&(window.imageInit=!0,self.showXMore()))}}));globalThis.showXMore=async function(t){let e=[];for(let n=window.maxCount;n<window.maxCount+window.maxCountIncrease;n++)try{if(n<window.allSubmited.length){if(!window.allSubmited[n].toString().includes("%"))e.push(window.allImages[n-window.decalage]);else{document.getElementById(window.allSubmited[n]).getElementsByClassName("header")[1].style.height="100px",document.getElementById(window.allSubmited[n]).getElementsByClassName("header")[1].style.width="186px";let l=(Math.random()>.5?-1:1)*(Math.random()*6);document.getElementById(window.allSubmited[n]).style.transform+="rotate("+l+"deg)";let d=document.getElementById(window.allSubmited[n]).getElementsByClassName("splash"),o=window.splashPosition[Math.floor(Math.random()*6)+1];for(let m=0;m<d.length;m++){let g=o[m],r=d[m];r.firstChild.style.top=g[0],r.firstChild.style.bottom=g[1],r.firstChild.style.left=g[2],r.firstChild.style.right=g[3],r.firstChild.src="/themes/core/static/img/splash"+(Math.floor(Math.random()*5)+1)+".png"}window.laoded+=1,window.decalage++}document.getElementById(window.allSubmited[n]).hidden=!1}}catch{}const i=await(await h.fetch("/api/v1/teams?ids="+JSON.stringify(e),{method:"GET"})).json();for(let n=0;n<window.maxCountIncrease;n++)try{if(n<e.length){let l=i.data[n].provided,d=document.getElementById(e[n]),o=!1;try{o=JSON.parse(l)}catch{}if(o){let m=!1,g=!1;for(let r=0;r<o.length;r++)o[r].type=="video/webm"&&(g=!0);for(let r=0;r<o.length;r++)if(o[r].type=="thumbsnail"){m=!0;let w=createMediaElement(o[r]);w.style["max-width"]="100%",w.style.display="block",w.style.height="auto",w.onload=function(p){stylingImage(p,o.length)},d.getElementsByClassName("imageContainer")[0].value!=!0&&(g&&(d.getElementsByClassName("imageContainer")[0].innerHTML+=`<svg
                  style="position: absolute;z-index: 10;top: 10%;left: -10%;pointer-events: none;"
                    width="200"
                    height="200"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path d="M15 12.3301L9 16.6603L9 8L15 12.3301Z" fill="#212529" />
               
                  </svg>`),d.getElementsByClassName("imageContainer")[0].appendChild(w),console.log(w.className),d.getElementsByClassName("imageContainer")[0].value=!0),d.getElementsByClassName("imageContainer")[0].onclick=showLargeSubmissions,d.value=l}if(!m){let r=document.createElement("p");r.textContent="No thumbsnail Available for the current media",d.getElementsByClassName("imageContainer")[0].appendChild(r)}}}}catch{}window.maxCount+=window.maxCountIncrease,(window.laoded==window.allSubmited.length||window.laoded==window.maxCount)&&drawLines(),window.allSubmited.length<=window.maxCount&&(document.getElementById("plus-btn").disabled=!0);let s=document.getElementsByClassName("award-icon");for(let n=0;n<s.length;n++)s[n].parentElement.getElementsByClassName("challenge_name")[0].textContent||(s[n].hidden=!1,s[n].parentElement.getElementsByClassName("challenge_name")[0].hidden=!0)};globalThis.stylingImage=function(t,e){const a=t.target;a.naturalWidth>a.naturalHeight?(a.classList.add("landscape"),a.parentElement.classList.add("landscape-td"),a.parentElement.parentElement.parentElement.classList.add("landscape-td")):(a.classList.add("portrait"),a.parentElement.classList.add("portrait-td"),a.parentElement.parentElement.parentElement.classList.add("portrait-td"));let i=(Math.random()>.5?-1:1)*(Math.random()*6);a.parentElement.parentElement.parentElement.style.transform+="rotate("+i+"deg)";let s=a.parentElement.parentElement.parentElement.getElementsByClassName("splash"),n=window.splashPosition[Math.floor(Math.random()*6)+1];for(let l=0;l<s.length;l++){let d=n[l],o=s[l];o.firstChild.style.top=d[0],o.firstChild.style.bottom=d[1],o.firstChild.style.left=d[2],o.firstChild.style.right=d[3],o.firstChild.src="/themes/core/static/img/splash"+(Math.floor(Math.random()*5)+1)+".png"}window.laoded+=1,(window.laoded==window.allSubmited.length||window.laoded==window.maxCount)&&drawLines(),a.parentElement.parentElement.getElementsByClassName("imageContainer")[0].innerHTML+="<i class='fa fa-image "+(a.className=="portrait"?"portrait-icon":"")+`' style="position: absolute;color: #212529;z-index: 50;top:75%;left: 5%"></i><p class='`+(a.className=="portrait"?"portrait-text":"")+`' style="position: absolute;color: #212529;z-index: 50;top:72.5%;left: 15%">`+(e-1)+"</p>",a.parentElement.parentElement.getElementsByClassName("imageContainer")[0].innerHTML+=""};globalThis.drawLines=function(){document.body.getBoundingClientRect();let t=window.maxCount-window.maxCountIncrease;for(let s=t==0?t:t-2;s<window.laoded-1;s++){var i=document.getElementsByClassName("lineCanvas")[s];i.hidden=!1;try{let l=document.getElementsByClassName("lineStart")[s],d=document.getElementsByClassName("lineStart")[s+1],o=l.getBoundingClientRect(),m=d.getBoundingClientRect();var i=document.getElementsByClassName("lineCanvas")[s];let r=i.parentElement.parentElement.parentElement.style.transform,w=parseFloat(r.split("rotate(")[1].split("deg")[0]);i.style.transform="rotate("+-w+"deg)",i.style.left=(m.left<o.left?m.left-o.left:0)+"px",console.log(d);let p=i.getBoundingClientRect();console.log(m.left),i.width=m.left-p.left+Math.abs(o.left-p.left)+l.offsetHeight/2,i.height=m.top-p.top+Math.abs(o.top-p.top)+l.offsetWidth/2;let u={x:o.left-p.left+l.offsetWidth/2,y:o.top-p.top+l.offsetHeight/2},f={x:m.left-p.left+(m.left<o.left?l.offsetWidth:0),y:m.top-p.top+d.offsetHeight/4};var e=i.getContext("2d"),a=e.createLinearGradient(u.x,u.y,f.x,i.height);a.addColorStop(0,l.value),a.addColorStop(1,d.value),e.setLineDash([40,20]),e.strokeStyle=a,e.beginPath(),e.lineWidth="7",e.moveTo(u.x,u.y),e.lineTo(f.x,f.y),e.stroke()}catch(l){i.style.width="0px",console.log(l)}}var i=document.getElementsByClassName("lineCanvas")[window.laoded-1];i.hidden=!0};globalThis.createMediaElement=function(t){let e;return t.type=="video/webm"?(e=document.createElement("video"),e.controls=!0,e.type="video/webm",e.poster=""):(t.type=="image/png"||t.type=="thumbsnail")&&(e=document.createElement("img"),e.type="image/png"),e.src="/files/"+t.location,e};globalThis.showLargeSubmissions=function(t){window.carouselPosition=0;let e,a;try{e=JSON.parse(t.srcElement.parentElement.parentElement.value),a=t.srcElement.parentElement.parentElement}catch{e=JSON.parse(t.srcElement.parentElement.parentElement.parentElement.value),a=t.srcElement.parentElement.parentElement.parentElement}console.log(e);let i=!1;window.carouselMax=e.length-1;let s="<section class='slider-wrapper'><ul class='slides-container list-unstyled' style:'list-style: none !important;' id='slides-container'>";for(let n=0;n<e.length;n++)if(e[n].type!="thumbsnail"){let l=createMediaElement(e[n]);l.style.width="100%",l.style.objectFit="contain",l.style.height="500px";let d=document.createElement("div");d.append(l),s+='<li class="slide '+(i?n-1:n)+'slide" style="min-height:50%">',s+=d.innerHTML,s+="</li>"}else i=!0;s+="</ul></section>",s+="<img src onerror='reloadCarousel(this.parentElement);'></img>",s+=`<button class='btn btn-primary carousel__navigation-button slide-arrow-prev' id='slide-arrow-prev' onclick='downCarousel(this)' style='display:block;position:absolute;top:40%;left:1rem;'><svg viewBox="0 0 100 100"><path d="M 50,0 L 60,10 L 20,50 L 60,90 L 50,100 L 0,50 Z" class="arrow" fill="white" transform="translate(15,0) rotate(0)"></path></svg></button>`,s+=`<button style='position:absolute;top:40%;right:1rem;' class='btn btn-primary carousel__navigation-button slide-arrow-next' id='slide-arrow-next' onclick='upCarousel(this)'><svg viewBox="0 0 100 100"><path d="M 50,0 L 60,10 L 20,50 L 60,90 L 50,100 L 0,50 Z" class="arrow" fill="white" transform="translate(85,100) rotate(180)"></path></svg></button>`,C({title:"Visioneurs",body:s,button:"retour",challenge_id:a.text,ids:a.id,additionalClassMain:"FullSizeCarousel"},x,h.user),document.getElementsByClassName("modal-dialog")[0].style.listStyle="none"};window.upCarousel=function(t){window.carouselPosition+=1,window.carouselPosition!=window.carouselMax-1?(window.reloadCarousel(t.parentElement),t.parentElement.getElementsByClassName("slide-arrow-prev")[0].hidden=!1):(window.reloadCarousel(t.parentElement),t.parentElement.getElementsByClassName("slide-arrow-next")[0].hidden=!0,t.parentElement.getElementsByClassName("slide-arrow-prev")[0].hidden=!1)};window.downCarousel=function(t){window.carouselPosition-=1,window.carouselPosition!=0?(window.reloadCarousel(t.parentElement),t.parentElement.getElementsByClassName("slide-arrow-next")[0].hidden=!1):(window.reloadCarousel(t.parentElement),t.parentElement.getElementsByClassName("slide-arrow-prev")[0].hiddend=!0,t.parentElement.getElementsByClassName("slide-arrow-next")[0].hidden=!1)};window.reloadCarousel=function(t){window.carouselPosition==0&&(t.getElementsByClassName("slide-arrow-prev")[0].hidden=!0),window.carouselMax==1&&(t.getElementsByClassName("slide-arrow-next")[0].hidden=!0);for(let e=0;e<window.carouselMax;e++)if(e==window.carouselPosition)t.getElementsByClassName(e+"slide")[0].hidden=!1;else{t.getElementsByClassName(e+"slide")[0].hidden=!0;let a=t.getElementsByClassName(e+"slide")[0].firstChild;a.nodeName=="VIDEO"&&a.pause()}};c.start();
